<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Orbot - By Saqib</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    * {
      font-family: 'Poppins', sans-serif;
    }

    body {
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
      color: #e2e8f0;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* 3D Card Effects */
    .card-3d {
      background: rgba(30, 41, 59, 0.7);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      border: 1px solid rgba(94, 234, 212, 0.1);
      box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        0 0 20px rgba(94, 234, 212, 0.1);
      transform-style: preserve-3d;
      transition: transform 0.4s ease, box-shadow 0.4s ease;
    }

    .card-3d:hover {
      transform: translateY(-8px) rotateX(5deg);
      box-shadow: 
        0 20px 40px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.15),
        0 0 30px rgba(94, 234, 212, 0.2);
    }

    /* 3D Button Effects */
    .btn-3d {
      background: linear-gradient(135deg, #0ea5e9 0%, #3b82f6 100%);
      border: none;
      border-radius: 12px;
      box-shadow: 
        0 6px 0 #1d4ed8,
        0 10px 20px rgba(0, 0, 0, 0.3);
      transition: all 0.2s ease;
      position: relative;
      overflow: hidden;
    }

    .btn-3d:active {
      transform: translateY(4px);
      box-shadow: 
        0 2px 0 #1d4ed8,
        0 5px 10px rgba(0, 0, 0, 0.2);
    }

    .btn-3d::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }

    .btn-3d:hover::after {
      left: 100%;
    }

    /* Glow Effects */
    .glow {
      text-shadow: 0 0 10px rgba(94, 234, 212, 0.7);
    }

    .glow-box {
      box-shadow: 0 0 20px rgba(94, 234, 212, 0.3);
    }

    /* 3D Input */
    .input-3d {
      background: rgba(15, 23, 42, 0.7);
      border: 1px solid rgba(94, 234, 212, 0.2);
      border-radius: 12px;
      box-shadow: 
        inset 0 2px 4px rgba(0, 0, 0, 0.3),
        0 5px 15px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
    }

    .input-3d:focus {
      border-color: #60a5fa;
      box-shadow: 
        inset 0 2px 4px rgba(0, 0, 0, 0.3),
        0 5px 15px rgba(0, 0, 0, 0.1),
        0 0 0 3px rgba(96, 165, 250, 0.3);
      transform: translateY(-2px);
    }

    /* Animated Background */
    .bg-animated {
      background: linear-gradient(-45deg, #0f172a, #1e293b, #1e3a8a, #0f172a);
      background-size: 400% 400%;
      animation: gradient 15s ease infinite;
    }

    @keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Floating Animation */
    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(5deg); }
    }

    .floating {
      animation: float 6s ease-in-out infinite;
    }

    /* 3D Tabs */
    .tab-3d {
      background: rgba(30, 41, 59, 0.5);
      border-radius: 10px 10px 0 0;
      border: 1px solid rgba(94, 234, 212, 0.1);
      border-bottom: none;
      transition: all 0.3s ease;
      transform: perspective(500px) rotateX(20deg);
      transform-origin: bottom;
    }

    .tab-3d.active {
      background: rgba(30, 41, 59, 0.9);
      transform: perspective(500px) rotateX(0deg);
      border-color: rgba(94, 234, 212, 0.3);
      box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.2);
    }

    /* Custom Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(15, 23, 42, 0.5);
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb {
      background: linear-gradient(180deg, #0ea5e9, #3b82f6);
      border-radius: 10px;
    }

    /* Fade Animation */
    .fade-in {
      animation: fadeIn 0.5s ease forwards;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Shine Effect */
    .shine {
      position: relative;
      overflow: hidden;
    }

    .shine::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.7s;
    }

    .shine:hover::before {
      left: 100%;
    }

    /* 3D Avatar */
    .avatar-3d {
      border-radius: 50%;
      border: 3px solid #0ea5e9;
      box-shadow: 
        0 0 20px rgba(14, 165, 233, 0.5),
        inset 0 0 20px rgba(14, 165, 233, 0.2);
      transform: perspective(500px) rotateY(-10deg);
      transition: transform 0.5s ease;
    }

    .avatar-3d:hover {
      transform: perspective(500px) rotateY(10deg);
    }
  </style>
</head>
<body class="bg-animated min-h-screen flex flex-col">
  <!-- Animated Background Elements -->
  <div class="fixed inset-0 overflow-hidden pointer-events-none z-0">
    <div class="absolute top-10 left-10 w-72 h-72 bg-blue-500/5 rounded-full blur-3xl floating"></div>
    <div class="absolute bottom-20 right-10 w-96 h-96 bg-cyan-500/5 rounded-full blur-3xl floating" style="animation-delay: 2s;"></div>
    <div class="absolute top-1/2 left-1/3 w-64 h-64 bg-indigo-500/5 rounded-full blur-3xl floating" style="animation-delay: 4s;"></div>
  </div>

  <!-- Header -->
  <header class="relative z-10">
    <div class="container mx-auto px-4 py-6">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="flex items-center gap-4 mb-6 md:mb-0">
          <div class="relative">
            <div class="absolute inset-0 bg-cyan-500/20 blur-xl rounded-full"></div>
            <i class="fa-solid fa-robot text-4xl text-cyan-400 relative z-10"></i>
          </div>
          <div>
            <h1 class="text-3xl font-bold glow">ORBOT</h1>
            <p class="text-sm text-cyan-300/70">Telegram Bot Manager</p>
          </div>
        </div>
        
        <nav class="flex gap-1 bg-slate-900/50 backdrop-blur-sm rounded-2xl p-1 border border-slate-700/50">
          <a href="#" class="tab-3d px-5 py-3 text-sm font-medium" data-page="main">
            <i class="fas fa-home mr-2"></i>Dashboard
          </a>
          <a href="#" class="tab-3d px-5 py-3 text-sm font-medium" data-page="stats">
            <i class="fas fa-chart-bar mr-2"></i>Analytics
          </a>
          <a href="#" class="tab-3d px-5 py-3 text-sm font-medium" data-page="help">
            <i class="fas fa-question-circle mr-2"></i>Guide
          </a>
          <a href="#" class="tab-3d px-5 py-3 text-sm font-medium" data-page="settings">
            <i class="fas fa-cog mr-2"></i>Settings
          </a>
        </nav>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="flex-grow container mx-auto px-4 py-6 relative z-10">
    <div id="app" class="w-full max-w-4xl mx-auto"></div>
  </main>

  <!-- Footer -->
  <footer class="relative z-10 py-8">
    <div class="container mx-auto px-4 text-center">
      <div class="inline-flex items-center gap-2 px-6 py-3 card-3d">
        <p class="text-slate-400">Made with <i class="fa-solid fa-heart text-red-400 mx-1"></i> by <a href="https://sawwqib.vercel.app" class="text-cyan-300 font-medium hover:text-cyan-200 transition-colors">Saqib</a></p>
        <div class="h-4 w-px bg-slate-600"></div>
        <p class="text-slate-400">Powered by <span class="text-cyan-300 font-medium">Telegram Bot API</span></p>
      </div>
    </div>
  </footer>

  <script>
    // --- Token Checker Web App ---

    // --- State ---
    const app = document.getElementById('app');
    let userState = null;
    let userToken = null;
    let userBotInfo = null;
    let uploadedPhoto = null;
    let stats = {
      users: 1428,
      tokensChecked: 0,
      startedAt: Date.now()
    };

    const STATE = {
      MAIN: 'main',
      WAIT_TOKEN: 'wait_token',
      WAIT_PHOTO: 'wait_photo',
      WAIT_NAME: 'wait_name',
      SHOW_RESULT: 'show_result',
      SETTINGS: 'settings',
      HELP: 'help',
      STATS: 'stats',
    };

    // --- Telegram Bot API Functions ---
    async function checkToken(token) {
      try {
        const response = await fetch(`https://api.telegram.org/bot${token}/getMe`);
        const data = await response.json();
        
        if (data.ok) {
          return {
            valid: true,
            username: data.result.username,
            first_name: data.result.first_name,
            id: data.result.id,
            can_join_groups: data.result.can_join_groups || false,
            can_read_all_group_messages: data.result.can_read_all_group_messages || false,
            supports_inline_queries: data.result.supports_inline_queries || false,
            is_bot: data.result.is_bot
          };
        } else {
          return {
            valid: false,
            error: data.description || 'Unknown error'
          };
        }
      } catch (error) {
        return {
          valid: false,
          error: 'Network error or invalid token'
        };
      }
    }

    async function setBotProfilePhoto(token, photoData) {
      try {
        const formData = new FormData();
        const blob = await (await fetch(photoData)).blob();
        formData.append('photo', blob, 'profile_photo.jpg');
        
        const response = await fetch(`https://api.telegram.org/bot${token}/setChatPhoto`, {
          method: 'POST',
          body: formData
        });
        
        const data = await response.json();
        return data.ok;
      } catch (error) {
        return false;
      }
    }

    async function setBotName(token, newName) {
      try {
        const response = await fetch(`https://api.telegram.org/bot${token}/setMyName`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            name: newName
          })
        });
        
        const data = await response.json();
        return data.ok;
      } catch (error) {
        return false;
      }
    }

    // --- UI Rendering ---
    function render() {
      switch (userState) {
        case STATE.WAIT_TOKEN:
          renderTokenInput(); break;
        case STATE.WAIT_PHOTO:
          renderPhotoUpload(); break;
        case STATE.WAIT_NAME:
          renderNameInput(); break;
        case STATE.SETTINGS:
          renderSettings(); break;
        case STATE.HELP:
          renderHelp(); break;
        case STATE.STATS:
          renderStats(); break;
        case STATE.SHOW_RESULT:
          renderTokenResult(); break;
        default:
          renderMain(); break;
      }
    }

    function setState(state) {
      userState = state;
      render();
      updateNavigation(state);
    }

    function updateNavigation(state) {
      document.querySelectorAll('.tab-3d').forEach(tab => {
        tab.classList.remove('active');
        if (tab.getAttribute('data-page') === state) {
          tab.classList.add('active');
        }
      });
    }

    // --- Main Page ---
    function renderMain() {
      app.innerHTML = `
        <div class="fade-in">
          <div class="text-center mb-10">
            <h2 class="text-4xl font-bold mb-3 glow">Telegram Bot <span class="text-cyan-400">Control Panel</span></h2>
            <p class="text-slate-400 max-w-2xl mx-auto">Validate bot tokens, customize profile, and analyze statistics with our immersive 3D interface</p>
          </div>
          
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
            <div class="card-3d p-6 shine">
              <div class="flex items-center gap-4 mb-4">
                <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center">
                  <i class="fas fa-key text-white text-xl"></i>
                </div>
                <h3 class="text-xl font-bold">Token Validator</h3>
              </div>
              <p class="text-slate-400 text-sm mb-4">Check Telegram bot token validity and view detailed information about your bot.</p>
            </div>
            
            <div class="card-3d p-6 shine">
              <div class="flex items-center gap-4 mb-4">
                <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-purple-500 to-pink-600 flex items-center justify-center">
                  <i class="fas fa-robot text-white text-xl"></i>
                </div>
                <h3 class="text-xl font-bold">Bot Customizer</h3>
              </div>
              <p class="text-slate-400 text-sm mb-4">Update bot profile picture and display name directly through the Telegram API.</p>
            </div>
            
            <div class="card-3d p-6 shine">
              <div class="flex items-center gap-4 mb-4">
                <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-green-500 to-emerald-600 flex items-center justify-center">
                  <i class="fas fa-chart-line text-white text-xl"></i>
                </div>
                <h3 class="text-xl font-bold">Analytics</h3>
              </div>
              <p class="text-slate-400 text-sm mb-4">Track usage statistics, token checks, and system performance metrics.</p>
            </div>
          </div>
          
          <div class="card-3d p-8">
            <div class="flex items-center gap-3 mb-6">
              <div class="w-10 h-10 rounded-lg bg-gradient-to-r from-cyan-500 to-blue-500 flex items-center justify-center">
                <i class="fas fa-terminal text-white"></i>
              </div>
              <h3 class="text-2xl font-bold">Enter Bot Token</h3>
            </div>
            
            <form class="flex flex-col gap-6" id="tokenForm">
              <div class="relative">
                <input class="input-3d w-full px-6 py-4 text-lg" type="text" name="token" placeholder="Paste your Telegram bot token here..." autocomplete="off" required minlength="35" spellcheck="false">
                <div class="absolute right-4 top-1/2 transform -translate-y-1/2">
                  <i class="fas fa-lock text-cyan-400/50"></i>
                </div>
              </div>
              
              <div class="flex flex-row gap-4">
                <button class="btn-3d flex-1 text-white font-bold py-4 rounded-xl text-lg" type="submit">
                  <i class="fas fa-search mr-3"></i>Validate Token
                </button>
                <button class="px-6 py-4 border border-slate-700 rounded-xl font-medium hover:bg-slate-800/50 transition-colors" type="button" onclick="showToast('Sample token format: 123456789:ABCdefGHIjklMNOpqrsTUVwxyz')">
                  <i class="fas fa-info-circle mr-2"></i>Format Help
                </button>
              </div>
              
              <div class="text-sm text-slate-500 text-center">
                Token format: <span class="font-mono text-cyan-300">123456789:ABCDEFGHIJKLMNOPQRSTUVWXYZ</span>
              </div>
            </form>
          </div>
        </div>
      `;
      document.getElementById('tokenForm').onsubmit = handleTokenSubmit;
    }

    async function handleTokenSubmit(e) {
      e.preventDefault();
      const token = e.target.token.value.trim();
      if (!/^\d{8,}:[a-zA-Z0-9_-]{30,}$/.test(token)) {
        showError('Invalid token format! The token should look like: 123456789:ABCDEFGHIJKLMNOPQRSTUVWXYZ');
        return;
      }
      setLoading('üîç Validating token with Telegram API...');
      const res = await checkToken(token);
      removeLoading();
      if (res.valid) {
        userToken = token;
        userBotInfo = res;
        stats.tokensChecked++;
        setState(STATE.SHOW_RESULT);
      } else {
        showError(`Token validation failed! Reason: ${res.error}`);
      }
    }

    // --- Token Result ---
    function renderTokenResult() {
      const bot = userBotInfo;
      app.innerHTML = `
        <div class="fade-in">
          <div class="flex items-center justify-between mb-8">
            <h2 class="text-3xl font-bold">Bot <span class="text-cyan-400">Dashboard</span></h2>
            <button class="btn-3d px-6 py-3 text-white font-bold" onclick="setState(STATE.MAIN)">
              <i class="fas fa-arrow-left mr-2"></i>Back
            </button>
          </div>
          
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-2">
              <div class="card-3d p-8">
                <div class="flex flex-col md:flex-row items-center gap-8 mb-8">
                  <div class="relative">
                    <img src="${uploadedPhoto ? uploadedPhoto : `https://api.telegram.org/bot${userToken}/getUserProfilePhotos?user_id=${bot.id}&limit=1`}" 
                         class="avatar-3d w-32 h-32" 
                         alt="Bot profile" 
                         onerror="this.src='https://api.dicebear.com/7.x/bottts/svg?seed=' + ${bot.id}">
                    <div class="absolute -bottom-2 -right-2 w-10 h-10 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-full flex items-center justify-center border-4 border-slate-900">
                      <i class="fas fa-check text-white text-sm"></i>
                    </div>
                  </div>
                  
                  <div class="flex-1">
                    <div class="flex items-center gap-3 mb-3">
                      <h3 class="text-2xl font-bold">${bot.first_name}</h3>
                      <span class="px-3 py-1 bg-slate-800 rounded-full text-sm font-medium">@${bot.username}</span>
                    </div>
                    <p class="text-slate-400 mb-4">Telegram Bot ID: <span class="font-mono text-cyan-300">${bot.id}</span></p>
                    
                    <div class="flex flex-wrap gap-3">
                      <button class="btn-3d px-5 py-2.5 text-white font-medium text-sm" onclick="setState(STATE.WAIT_PHOTO)">
                        <i class="fas fa-image mr-2"></i>Change Avatar
                      </button>
                      <button class="px-5 py-2.5 border border-cyan-500/30 text-cyan-300 rounded-lg font-medium text-sm hover:bg-cyan-500/10 transition-colors" onclick="setState(STATE.WAIT_NAME)">
                        <i class="fas fa-pen mr-2"></i>Rename Bot
                      </button>
                      <button class="px-5 py-2.5 border border-slate-700 rounded-lg font-medium text-sm hover:bg-slate-800/50 transition-colors" onclick="recheckToken()">
                        <i class="fas fa-sync-alt mr-2"></i>Revalidate
                      </button>
                    </div>
                  </div>
                </div>
                
                <h4 class="text-xl font-bold mb-4">Bot Capabilities</h4>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                  <div class="bg-slate-800/50 rounded-xl p-4 text-center">
                    <div class="w-12 h-12 mx-auto rounded-full ${bot.can_join_groups ? 'bg-green-500/20' : 'bg-red-500/20'} flex items-center justify-center mb-2">
                      <i class="fas ${bot.can_join_groups ? 'fa-users text-green-400' : 'fa-user-slash text-red-400'} text-xl"></i>
                    </div>
                    <p class="font-medium">Join Groups</p>
                    <p class="text-sm ${bot.can_join_groups ? 'text-green-400' : 'text-red-400'}">${bot.can_join_groups ? 'Allowed' : 'Not Allowed'}</p>
                  </div>
                  
                  <div class="bg-slate-800/50 rounded-xl p-4 text-center">
                    <div class="w-12 h-12 mx-auto rounded-full ${bot.can_read_all_group_messages ? 'bg-green-500/20' : 'bg-red-500/20'} flex items-center justify-center mb-2">
                      <i class="fas ${bot.can_read_all_group_messages ? 'fa-eye text-green-400' : 'fa-eye-slash text-red-400'} text-xl"></i>
                    </div>
                    <p class="font-medium">Read Messages</p>
                    <p class="text-sm ${bot.can_read_all_group_messages ? 'text-green-400' : 'text-red-400'}">${bot.can_read_all_group_messages ? 'Enabled' : 'Disabled'}</p>
                  </div>
                  
                  <div class="bg-slate-800/50 rounded-xl p-4 text-center">
                    <div class="w-12 h-12 mx-auto rounded-full ${bot.supports_inline_queries ? 'bg-green-500/20' : 'bg-red-500/20'} flex items-center justify-center mb-2">
                      <i class="fas ${bot.supports_inline_queries ? 'fa-bolt text-green-400' : 'fa-bolt-slash text-red-400'} text-xl"></i>
                    </div>
                    <p class="font-medium">Inline Queries</p>
                    <p class="text-sm ${bot.supports_inline_queries ? 'text-green-400' : 'text-red-400'}">${bot.supports_inline_queries ? 'Supported' : 'Not Supported'}</p>
                  </div>
                  
                  <div class="bg-slate-800/50 rounded-xl p-4 text-center">
                    <div class="w-12 h-12 mx-auto rounded-full bg-blue-500/20 flex items-center justify-center mb-2">
                      <i class="fas fa-robot text-blue-400 text-xl"></i>
                    </div>
                    <p class="font-medium">Bot Type</p>
                    <p class="text-sm text-blue-400">${bot.is_bot ? 'Official Bot' : 'User Account'}</p>
                  </div>
                </div>
              </div>
            </div>
            
            <div>
              <div class="card-3d p-6 mb-6">
                <h4 class="text-lg font-bold mb-4">Quick Actions</h4>
                <div class="space-y-3">
                  <button class="w-full btn-3d py-3 text-white font-medium" onclick="setState(STATE.WAIT_PHOTO)">
                    <i class="fas fa-camera mr-2"></i>Update Profile Photo
                  </button>
                  <button class="w-full py-3 border border-cyan-500/30 text-cyan-300 rounded-lg font-medium hover:bg-cyan-500/10 transition-colors" onclick="setState(STATE.WAIT_NAME)">
                    <i class="fas fa-font mr-2"></i>Change Display Name
                  </button>
                  <button class="w-full py-3 border border-slate-700 rounded-lg font-medium hover:bg-slate-800/50 transition-colors" onclick="recheckToken()">
                    <i class="fas fa-shield-alt mr-2"></i>Re-validate Token
                  </button>
                  <button class="w-full py-3 border border-red-500/30 text-red-400 rounded-lg font-medium hover:bg-red-500/10 transition-colors" onclick="deletePhoto()">
                    <i class="fas fa-trash-alt mr-2"></i>Remove Local Image
                  </button>
                </div>
              </div>
              
              <div class="card-3d p-6">
                <h4 class="text-lg font-bold mb-4">Token Info</h4>
                <div class="space-y-3">
                  <div>
                    <p class="text-sm text-slate-500">Token Preview</p>
                    <div class="font-mono text-sm bg-slate-900/50 p-3 rounded-lg mt-1 truncate">
                      ${userToken.substring(0, 15)}...${userToken.substring(userToken.length - 15)}
                    </div>
                  </div>
                  <div>
                    <p class="text-sm text-slate-500">Last Checked</p>
                    <p class="font-medium">Just now</p>
                  </div>
                  <div>
                    <p class="text-sm text-slate-500">Status</p>
                    <div class="flex items-center gap-2">
                      <div class="w-2 h-2 rounded-full bg-green-500"></div>
                      <p class="font-medium text-green-400">Valid & Active</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    async function recheckToken() {
      setLoading('Re-validating token...');
      const res = await checkToken(userToken);
      removeLoading();
      if (res.valid) {
        showToast('‚úÖ Token is still valid and active!');
        userBotInfo = res;
        setState(STATE.SHOW_RESULT);
      } else {
        showError('‚ùå Token is no longer valid!');
        setState(STATE.MAIN);
      }
    }

    function deletePhoto() {
      uploadedPhoto = null;
      showToast('üóëÔ∏è Local image cache cleared!');
      setState(STATE.SHOW_RESULT);
    }

    // --- Photo Upload ---
    function renderPhotoUpload() {
      app.innerHTML = `
        <div class="fade-in max-w-2xl mx-auto">
          <div class="flex items-center gap-4 mb-8">
            <button class="btn-3d px-5 py-3 text-white font-bold" onclick="setState(STATE.SHOW_RESULT)">
              <i class="fas fa-arrow-left mr-2"></i>Back
            </button>
            <h2 class="text-3xl font-bold">Update <span class="text-cyan-400">Bot Avatar</span></h2>
          </div>
          
          <div class="card-3d p-8">
            <form class="flex flex-col gap-8" id="photoForm">
              <div class="text-center">
                <div class="relative inline-block">
                  <img src="${uploadedPhoto ? uploadedPhoto : `https://api.telegram.org/bot${userToken}/getUserProfilePhotos?user_id=${userBotInfo.id}&limit=1`}" 
                       class="avatar-3d w-48 h-48 mb-6" 
                       alt="Preview" 
                       onerror="this.src='https://api.dicebear.com/7.x/bottts/svg?seed=' + ${userBotInfo.id}">
                  <div class="absolute bottom-4 right-4">
                    <label for="photoInput" class="cursor-pointer">
                      <div class="w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-600 rounded-full flex items-center justify-center shadow-lg hover:scale-110 transition-transform">
                        <i class="fas fa-camera text-white text-lg"></i>
                      </div>
                      <input type="file" accept="image/jpeg,image/png" id="photoInput" class="hidden">
                    </label>
                  </div>
                </div>
                <h3 class="text-xl font-bold mb-2">@${userBotInfo.username}</h3>
                <p class="text-slate-400">Upload a new profile image for your bot</p>
              </div>
              
              <div class="bg-slate-900/50 rounded-xl p-4">
                <h4 class="font-bold mb-3 text-cyan-300">Requirements</h4>
                <ul class="space-y-2 text-sm">
                  <li class="flex items-center gap-2"><i class="fas fa-check-circle text-green-400"></i> JPG or PNG format only</li>
                  <li class="flex items-center gap-2"><i class="fas fa-check-circle text-green-400"></i> Maximum file size: 5 MB</li>
                  <li class="flex items-center gap-2"><i class="fas fa-check-circle text-green-400"></i> Square images work best</li>
                  <li class="flex items-center gap-2"><i class="fas fa-check-circle text-green-400"></i> Changes apply immediately via Telegram API</li>
                </ul>
              </div>
              
              <div class="flex gap-4">
                <button class="btn-3d flex-1 text-white font-bold py-4 rounded-xl" type="submit">
                  <i class="fas fa-cloud-upload-alt mr-3"></i>Upload to Telegram
                </button>
                <button class="px-6 py-4 border border-slate-700 rounded-xl font-medium hover:bg-slate-800/50 transition-colors" type="button" onclick="setState(STATE.SHOW_RESULT)">
                  Cancel
                </button>
              </div>
            </form>
          </div>
        </div>
      `;
      document.getElementById('photoForm').onsubmit = handlePhotoSubmit;
      document.getElementById('photoInput').onchange = handlePhotoChange;
    }

    function handlePhotoChange(e) {
      const file = e.target.files[0];
      if (!file) return;
      if (!/^image\/(jpeg|png)$/.test(file.type)) {
        showError('Only JPG or PNG images are allowed!');
        return;
      }
      if (file.size > 5 * 1024 * 1024) {
        showError('Image must be less than 5MB!');
        return;
      }
      const reader = new FileReader();
      reader.onload = function(ev) {
        uploadedPhoto = ev.target.result;
        renderPhotoUpload();
      };
      reader.readAsDataURL(file);
    }

    async function handlePhotoSubmit(e) {
      e.preventDefault();
      if (!uploadedPhoto) {
        showError('Please select an image first!');
        return;
      }
      setLoading('Uploading image to Telegram...');
      const success = await setBotProfilePhoto(userToken, uploadedPhoto);
      removeLoading();
      if (success) {
        showToast('‚úÖ Bot avatar updated successfully!');
        setState(STATE.SHOW_RESULT);
      } else {
        showError('‚ùå Failed to update bot avatar!');
      }
    }

    // --- Name Change ---
    function renderNameInput() {
      app.innerHTML = `
        <div class="fade-in max-w-2xl mx-auto">
          <div class="flex items-center gap-4 mb-8">
            <button class="btn-3d px-5 py-3 text-white font-bold" onclick="setState(STATE.SHOW_RESULT)">
              <i class="fas fa-arrow-left mr-2"></i>Back
            </button>
            <h2 class="text-3xl font-bold">Rename <span class="text-cyan-400">Bot</span></h2>
          </div>
          
          <div class="card-3d p-8">
            <form class="flex flex-col gap-8" id="nameForm">
              <div>
                <label class="block text-sm font-medium mb-3">New Bot Name</label>
                <input class="input-3d w-full px-6 py-4 text-lg" type="text" name="newName" placeholder="Enter new bot name..." autocomplete="off" required minlength="1" maxlength="64" value="${userBotInfo.first_name}">
                <div class="flex items-center gap-2 mt-3 text-sm text-slate-400">
                  <i class="fas fa-info-circle"></i>
                  <span>1‚Äì64 characters. Letters, numbers, and symbols are allowed.</span>
                </div>
              </div>
              
              <div class="bg-slate-900/50 rounded-xl p-4">
                <div class="flex items-center gap-4">
                  <div class="w-16 h-16 rounded-full bg-gradient-to-r from-cyan-500 to-blue-600 flex items-center justify-center">
                    <i class="fas fa-robot text-white text-2xl"></i>
                  </div>
                  <div>
                    <h4 class="font-bold">Preview</h4>
                    <p class="text-slate-300 text-lg" id="namePreview">${userBotInfo.first_name}</p>
                    <p class="text-slate-500 text-sm">@${userBotInfo.username}</p>
                  </div>
                </div>
              </div>
              
              <div class="flex gap-4">
                <button class="btn-3d flex-1 text-white font-bold py-4 rounded-xl" type="submit">
                  <i class="fas fa-check-circle mr-3"></i>Update Name
                </button>
                <button class="px-6 py-4 border border-slate-700 rounded-xl font-medium hover:bg-slate-800/50 transition-colors" type="button" onclick="setState(STATE.SHOW_RESULT)">
                  Cancel
                </button>
              </div>
            </form>
          </div>
        </div>
      `;
      document.getElementById('nameForm').onsubmit = handleNameSubmit;
      document.getElementById('nameForm').newName.addEventListener('input', function(e) {
        document.getElementById('namePreview').textContent = e.target.value || userBotInfo.first_name;
      });
    }

    async function handleNameSubmit(e) {
      e.preventDefault();
      const newName = e.target.newName.value.trim();
      if (newName.length < 1 || newName.length > 64) {
        showError('Name must be between 1 and 64 characters!');
        return;
      }
      setLoading('Updating bot name via Telegram API...');
      const success = await setBotName(userToken, newName);
      removeLoading();
      if (success) {
        userBotInfo.first_name = newName;
        showToast(`‚úÖ Bot name changed to "${newName}" successfully!`);
        setState(STATE.SHOW_RESULT);
      } else {
        showError('‚ùå Failed to change bot name!');
      }
    }

    // --- Settings ---
    function renderSettings() {
      app.innerHTML = `
        <div class="fade-in max-w-4xl mx-auto">
          <h2 class="text-3xl font-bold mb-8">System <span class="text-cyan-400">Settings</span></h2>
          
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-2">
              <div class="card-3d p-8">
                <div class="flex items-center gap-4 mb-8">
                  <div class="w-12 h-12 rounded-xl bg-gradient-to-r from-purple-500 to-pink-600 flex items-center justify-center">
                    <i class="fas fa-sliders-h text-white text-xl"></i>
                  </div>
                  <h3 class="text-2xl font-bold">Data Management</h3>
                </div>
                
                <div class="space-y-6">
                  <div class="flex items-center justify-between p-4 bg-slate-900/50 rounded-xl">
                    <div>
                      <h4 class="font-bold mb-1">Clear Token History</h4>
                      <p class="text-sm text-slate-400">Remove all stored tokens and bot information</p>
                    </div>
                    <button class="btn-3d px-6 py-3 text-white font-medium" onclick="clearData()">
                      Clear Data
                    </button>
                  </div>
                  
                  <div class="flex items-center justify-between p-4 bg-slate-900/50 rounded-xl">
                    <div>
                      <h4 class="font-bold mb-1">Reset User Session</h4>
                      <p class="text-sm text-slate-400">Clear current session and return to initial state</p>
                    </div>
                    <button class="px-6 py-3 border border-slate-700 rounded-lg font-medium hover:bg-slate-800/50 transition-colors" onclick="resetState()">
                      Reset Session
                    </button>
                  </div>
                  
                  <div class="flex items-center justify-between p-4 bg-slate-900/50 rounded-xl">
                    <div>
                      <h4 class="font-bold mb-1">View Last Token</h4>
                      <p class="text-sm text-slate-400">Display the most recently checked bot token</p>
                    </div>
                    <button class="px-6 py-3 border border-cyan-500/30 text-cyan-300 rounded-lg font-medium hover:bg-cyan-500/10 transition-colors" onclick="showLastToken()">
                      Show Token
                    </button>
                  </div>
                </div>
              </div>
            </div>
            
            <div>
              <div class="card-3d p-6 mb-6">
                <h4 class="text-lg font-bold mb-4">System Info</h4>
                <div class="space-y-4">
                  <div>
                    <p class="text-sm text-slate-500">Version</p>
                    <p class="font-medium">Orbot v2.1.0</p>
                  </div>
                  <div>
                    <p class="text-sm text-slate-500">API Status</p>
                    <div class="flex items-center gap-2">
                      <div class="w-2 h-2 rounded-full bg-green-500"></div>
                      <p class="font-medium text-green-400">Telegram API Online</p>
                    </div>
                  </div>
                  <div>
                    <p class="text-sm text-slate-500">UI Mode</p>
                    <div class="flex items-center gap-2">
                      <div class="w-8 h-4 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-full flex items-center justify-center">
                        <i class="fas fa-cube text-white text-xs"></i>
                      </div>
                      <p class="font-medium">3D Immersive</p>
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="card-3d p-6">
                <h4 class="text-lg font-bold mb-4">Danger Zone</h4>
                <div class="space-y-3">
                  <button class="w-full py-3 border border-red-500/30 text-red-400 rounded-lg font-medium hover:bg-red-500/10 transition-colors" onclick="showError('This would reset all data. Are you sure?')">
                    <i class="fas fa-bomb mr-2"></i>Factory Reset
                  </button>
                  <button class="w-full py-3 border border-red-500/30 text-red-400 rounded-lg font-medium hover:bg-red-500/10 transition-colors" onclick="showError('This would clear all logs. Are you sure?')">
                    <i class="fas fa-trash-alt mr-2"></i>Clear All Logs
                  </button>
                </div>
              </div>
            </div>
          </div>
          
          <button class="btn-3d mt-8 px-8 py-4 text-white font-bold" onclick="setState(STATE.MAIN)">
            <i class="fas fa-home mr-2"></i>Return to Dashboard
          </button>
        </div>
      `;
    }
    
    function clearData() {
      userToken = null;
      userBotInfo = null;
      uploadedPhoto = null;
      showToast('üóëÔ∏è All user data has been cleared!');
      setState(STATE.SETTINGS);
    }
    
    function resetState() {
      userToken = null;
      userBotInfo = null;
      uploadedPhoto = null;
      showToast('üîÑ User session reset successfully!');
      setState(STATE.MAIN);
    }
    
    function showLastToken() {
      if (!userToken) {
        showError('No token has been checked yet.');
        return;
      }
      showToast(`Last token: ${userToken.substring(0, 20)}...${userToken.substring(userToken.length - 10)}`);
    }

    // --- Help ---
    function renderHelp() {
      app.innerHTML = `
        <div class="fade-in max-w-4xl mx-auto">
          <h2 class="text-3xl font-bold mb-8">User <span class="text-cyan-400">Guide</span></h2>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <div class="card-3d p-8">
              <div class="flex items-center gap-4 mb-6">
                <div class="w-12 h-12 rounded-xl bg-gradient-to-r from-cyan-500 to-blue-600 flex items-center justify-center">
                  <i class="fas fa-key text-white text-xl"></i>
                </div>
                <h3 class="text-xl font-bold">Token Validation</h3>
              </div>
              <p class="text-slate-400 mb-4">Enter your Telegram bot token to verify its validity and view detailed bot information. The token format should be:</p>
              <div class="font-mono bg-slate-900/50 p-3 rounded-lg mb-4 text-sm">123456789:ABCDEFGHIJKLMNOPQRSTUVWXYZ</div>
              <p class="text-slate-400">Our system uses the official Telegram Bot API to validate tokens in real-time.</p>
            </div>
            
            <div class="card-3d p-8">
              <div class="flex items-center gap-4 mb-6">
                <div class="w-12 h-12 rounded-xl bg-gradient-to-r from-purple-500 to-pink-600 flex items-center justify-center">
                  <i class="fas fa-robot text-white text-xl"></i>
                </div>
                <h3 class="text-xl font-bold">Bot Customization</h3>
              </div>
              <p class="text-slate-400 mb-4">After validating a token, you can customize your bot directly through our interface:</p>
              <ul class="space-y-2 text-slate-400 text-sm">
                <li class="flex items-start gap-2"><i class="fas fa-camera mt-1 text-cyan-400"></i> <span>Change profile photo (JPG/PNG, max 5MB)</span></li>
                <li class="flex items-start gap-2"><i class="fas fa-font mt-1 text-cyan-400"></i> <span>Update bot display name (1-64 characters)</span></li>
                <li class="flex items-start gap-2"><i class="fas fa-sync-alt mt-1 text-cyan-400"></i> <span>Re-validate token status at any time</span></li>
              </ul>
            </div>
          </div>
          
          <div class="card-3d p-8">
            <div class="flex items-center gap-4 mb-6">
              <div class="w-12 h-12 rounded-xl bg-gradient-to-r from-green-500 to-emerald-600 flex items-center justify-center">
                <i class="fas fa-shield-alt text-white text-xl"></i>
              </div>
              <h3 class="text-xl font-bold">Security & Privacy</h3>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="bg-slate-900/50 rounded-xl p-5">
                <h4 class="font-bold mb-2 text-cyan-300">Data Handling</h4>
                <p class="text-sm text-slate-400">All token validation happens client-side. We don't store tokens on our servers. Tokens are only sent to Telegram's official API.</p>
              </div>
              <div class="bg-slate-900/50 rounded-xl p-5">
                <h4 class="font-bold mb-2 text-cyan-300">API Limitations</h4>
                <p class="text-sm text-slate-400">Bot API has rate limits. Avoid excessive requests. Some bot features may be restricted by Telegram based on bot settings.</p>
              </div>
            </div>
            <div class="mt-6 p-4 bg-blue-900/20 border border-blue-500/30 rounded-xl">
              <div class="flex items-center gap-3">
                <i class="fas fa-lightbulb text-yellow-400 text-xl"></i>
                <p class="text-blue-300">This tool uses real Telegram Bot API calls. All changes are applied directly to your actual bot.</p>
              </div>
            </div>
          </div>
          
          <button class="btn-3d mt-8 px-8 py-4 text-white font-bold" onclick="setState(STATE.MAIN)">
            <i class="fas fa-play mr-2"></i>Get Started
          </button>
        </div>
      `;
    }

    // --- Statistics ---
    function renderStats() {
      const uptimeSec = Math.floor((Date.now() - stats.startedAt) / 1000);
      const uptimeStr =
        uptimeSec < 60 ? `${uptimeSec} seconds` :
        uptimeSec < 3600 ? `${Math.floor(uptimeSec / 60)} minutes` :
        uptimeSec < 86400 ? `${Math.floor(uptimeSec / 3600)} hours` :
        `${Math.floor(uptimeSec / 86400)} days`;
      
      app.innerHTML = `
        <div class="fade-in max-w-4xl mx-auto">
          <h2 class="text-3xl font-bold mb-8">System <span class="text-cyan-400">Analytics</span></h2>
          
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="card-3d p-6 text-center">
              <div class="w-16 h-16 mx-auto rounded-full bg-gradient-to-r from-cyan-500 to-blue-600 flex items-center justify-center mb-4">
                <i class="fas fa-users text-white text-2xl"></i>
              </div>
              <h3 class="text-3xl font-bold mb-2">${stats.users.toLocaleString()}</h3>
              <p class="text-slate-400">Active Users</p>
            </div>
            
            <div class="card-3d p-6 text-center">
              <div class="w-16 h-16 mx-auto rounded-full bg-gradient-to-r from-purple-500 to-pink-600 flex items-center justify-center mb-4">
                <i class="fas fa-key text-white text-2xl"></i>
              </div>
              <h3 class="text-3xl font-bold mb-2">${stats.tokensChecked}</h3>
              <p class="text-slate-400">Tokens Validated</p>
            </div>
            
            <div class="card-3d p-6 text-center">
              <div class="w-16 h-16 mx-auto rounded-full bg-gradient-to-r from-green-500 to-emerald-600 flex items-center justify-center mb-4">
                <i class="fas fa-clock text-white text-2xl"></i>
              </div>
              <h3 class="text-3xl font-bold mb-2">${uptimeStr}</h3>
              <p class="text-slate-400">System Uptime</p>
            </div>
          </div>
          
          <div class="card-3d p-8">
            <h3 class="text-2xl font-bold mb-6">Performance Metrics</h3>
            
            <div class="space-y-6">
              <div>
                <div class="flex justify-between mb-2">
                  <span class="font-medium">API Response Time</span>
                  <span class="text-cyan-400 font-bold">~120ms</span>
                </div>
                <div class="w-full bg-slate-800 rounded-full h-2.5">
                  <div class="bg-gradient-to-r from-cyan-500 to-blue-600 h-2.5 rounded-full" style="width: 85%"></div>
                </div>
              </div>
              
              <div>
                <div class="flex justify-between mb-2">
                  <span class="font-medium">System Reliability</span>
                  <span class="text-green-400 font-bold">99.8%</span>
                </div>
                <div class="w-full bg-slate-800 rounded-full h-2.5">
                  <div class="bg-gradient-to-r from-green-500 to-emerald-600 h-2.5 rounded-full" style="width: 99%"></div>
                </div>
              </div>
              
              <div>
                <div class="flex justify-between mb-2">
                  <span class="font-medium">User Satisfaction</span>
                  <span class="text-yellow-400 font-bold">4.7/5.0</span>
                </div>
                <div class="w-full bg-slate-800 rounded-full h-2.5">
                  <div class="bg-gradient-to-r from-yellow-500 to-amber-600 h-2.5 rounded-full" style="width: 94%"></div>
                </div>
              </div>
            </div>
            
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-8 pt-8 border-t border-slate-800">
              <div class="text-center">
                <div class="text-2xl font-bold text-cyan-400">100%</div>
                <div class="text-sm text-slate-400">SSL Secure</div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold text-green-400">24/7</div>
                <div class="text-sm text-slate-400">Availability</div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold text-purple-400">0</div>
                <div class="text-sm text-slate-400">Outages</div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold text-blue-400">v2.1</div>
                <div class="text-sm text-slate-400">Version</div>
              </div>
            </div>
          </div>
          
          <button class="btn-3d mt-8 px-8 py-4 text-white font-bold" onclick="setState(STATE.MAIN)">
            <i class="fas fa-arrow-left mr-2"></i>Back to Dashboard
          </button>
        </div>
      `;
    }

    // --- Toast & Loading ---
    function showToast(msg) {
      let toast = document.createElement('div');
      toast.className = 'fixed bottom-6 right-6 bg-gradient-to-r from-cyan-600 to-blue-600 text-white rounded-xl shadow-2xl px-6 py-4 fade-in z-50 max-w-sm';
      toast.innerHTML = `<div class="flex items-center gap-3"><i class="fas fa-check-circle"></i><span>${msg}</span></div>`;
      document.body.appendChild(toast);
      setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transform = 'translateY(20px)';
        setTimeout(() => toast.remove(), 400);
      }, 3000);
    }
    
    function showError(msg) {
      let err = document.createElement('div');
      err.className = 'fixed top-6 left-1/2 -translate-x-1/2 bg-gradient-to-r from-red-500 to-pink-600 text-white rounded-xl shadow-2xl px-6 py-4 fade-in z-50 text-center max-w-md';
      err.innerHTML = `<div class="flex items-center gap-3 justify-center"><i class="fas fa-exclamation-triangle"></i><span>${msg}</span></div>`;
      document.body.appendChild(err);
      setTimeout(() => {
        err.style.opacity = '0';
        setTimeout(() => err.remove(), 400);
      }, 4000);
    }
    
    let loadingDiv = null;
    function setLoading(msg) {
      removeLoading();
      loadingDiv = document.createElement('div');
      loadingDiv.className = 'fixed inset-0 bg-black/70 flex items-center justify-center z-50 fade-in';
      loadingDiv.innerHTML = `
        <div class='bg-slate-900 px-10 py-8 rounded-2xl shadow-2xl flex flex-col items-center gap-4 border border-cyan-500/30'>
          <div class="relative">
            <div class="w-16 h-16 border-4 border-cyan-500/30 border-t-cyan-500 rounded-full animate-spin"></div>
            <div class="absolute inset-0 flex items-center justify-center">
              <i class='fa-solid fa-robot text-cyan-400 text-2xl'></i>
            </div>
          </div>
          <span class='text-white font-semibold text-lg'>${msg}</span>
        </div>`;
      document.body.appendChild(loadingDiv);
    }
    
    function removeLoading() {
      if (loadingDiv) { loadingDiv.remove(); loadingDiv = null; }
    }

    // --- Navigation Event Listeners ---
    document.addEventListener('DOMContentLoaded', function() {
      // Add click handlers for navigation tabs
      document.querySelectorAll('.tab-3d').forEach(tab => {
        tab.addEventListener('click', function(e) {
          e.preventDefault();
          const page = this.getAttribute('data-page');
          setState(page);
        });
      });
      
      // Initialize the app
      setState(STATE.MAIN);
      
      // Add floating effect to cards on mouse move
      document.addEventListener('mousemove', function(e) {
        const cards = document.querySelectorAll('.card-3d');
        cards.forEach(card => {
          const rect = card.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;
          
          const centerX = rect.width / 2;
          const centerY = rect.height / 2;
          
          const rotateY = (x - centerX) / 25;
          const rotateX = (centerY - y) / 25;
          
          card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) translateY(-8px)`;
        });
      });
      
      // Reset card transforms when mouse leaves
      document.addEventListener('mouseleave', function() {
        const cards = document.querySelectorAll('.card-3d');
        cards.forEach(card => {
          card.style.transform = 'perspective(1000px) rotateX(0) rotateY(0) translateY(0)';
        });
      });
    });
  </script>
</body>
</html>

